import{j as e}from"./vendor-markdown-Dek94WS0.js";import{r as f}from"./vendor-react-V04_Axys.js";import{r as et,g as tt,m as st,i as rt}from"./workflowChat-DO10Wc9a.js";import{a as K,u as nt,W as at}from"./message-components-B3k4U96-.js";import"./input.js";import"./App-Bi6PTi-t.js";function ot(h,p){try{if(!h)return console.error("Invalid prompt_output: ",h),h;for(const i of p){if(!h[i.nodeId]){console.error(`Node with ID ${i.nodeId} not found`);continue}if(!h[i.nodeId].inputs){console.error(`Inputs not found for node with ID ${i.nodeId}`);continue}h[i.nodeId].inputs[i.paramName]=i.paramValue}return h}catch(i){return console.error("Error updating prompt:",i),h}}async function lt(h){const p=await K.graphToPrompt(),i=ot(p.output,h);console.log("queuePrompt updated_prompt:",i);const j={prompt:i,client_id:K.api.clientId,extra_data:{extra_pageinfo:{workflow:p.workflow}}};console.debug("queuePrompt request_body.prompt:",i);const y=await et(j);return console.debug("queuePrompt response:",y),y}function Se(h){const p=document.createElement("canvas"),i=p.getContext("2d");if(p.width=512,p.height=512,i){i.fillStyle="#f8d7da",i.fillRect(0,0,p.width,p.height),i.strokeStyle="#dc3545",i.lineWidth=4,i.strokeRect(10,10,p.width-20,p.height-20),i.fillStyle="#dc3545",i.beginPath(),i.arc(p.width/2,150,50,0,2*Math.PI),i.fill(),i.fillStyle="white",i.font="bold 80px Arial",i.textAlign="center",i.textBaseline="middle",i.fillText("!",p.width/2,150),i.fillStyle="#721c24",i.font="20px Arial",i.textAlign="center",i.textBaseline="middle";const j=p.width-60,y=30,k=h.split(" ");let C="",I=250;for(let L=0;L<k.length;L++){const $=C+k[L]+" ";i.measureText($).width>j&&L>0?(i.fillText(C,p.width/2,I),C=k[L]+" ",I+=y):C=$}i.fillText(C,p.width/2,I)}return p.toDataURL("image/png")}async function it(h){try{if(!h||h==="")return console.log("No prompt ID provided"),{1:[Se("Fail to generate prompt ID")]};const p=await tt(h);if(!p||!p[h])return console.log("Not finished for prompt ID:",h),{};const i=p[h];if(i.status&&i.status.status_str==="error"){console.error("Error for prompt ID:",h);const y=i.status.messages;if(y&&y.length>0){const k=y[y.length-1];if(k&&k.length>0){const C=k[0];return{1:[Se(C)]}}}}const j={};if(i.outputs)for(const y in i.outputs){const k=i.outputs[y];if(k&&k.images){j[y]=[];for(const C of k.images)if(C&&C.filename&&C.type){const I=`${window.location.origin}/view?filename=${encodeURIComponent(C.filename)}&type=${encodeURIComponent(C.type)}${C.subfolder?"&subfolder="+encodeURIComponent(C.subfolder):""}`;j[y].push(I)}console.log("outputImages for nodeId:",y,j[y])}}return j}catch(p){throw console.error("Error getting output images from prompt:",p),p}}function ct(){const h=Object.values(K.graph._nodes_by_id),p=[],i=[];for(const j of h)j.type==="SaveImage"?p.push(j.id):j.type==="PreviewImage"&&i.push(j.id);if(console.log("saveNodeIds:",p),console.log("previewNodeIds:",i),p.length===0&&i.length===0)throw new Error("No SaveImage or PreviewImage node found, please add one to the graph");if(p.length===1)return p[0];if(p.length==0&&i.length===1)return i[0];{const j=[...p,...i],y=prompt(`Multiple SaveImage and PreviewImage nodes detected with IDs ${j.join(",")}. Please enter the ID to use as the result`);return console.log("prompt input nodeId:",y),Number(y)}}async function dt(h,p){const i=await it(h);return Object.keys(i).length===0?null:i[p.toString()]&&i[p.toString()].length>0?i[p.toString()][0]:null}const xt=`
  @keyframes highlight-pulse {
    0% { 
      box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.5);
    }
    70% { 
      box-shadow: 0 0 0 15px rgba(59, 130, 246, 0);
    }
    100% { 
      box-shadow: 0 0 0 0 rgba(59, 130, 246, 0);
    }
  }
  
  .highlight-pulse {
    animation: highlight-pulse 1.5s infinite;
    border: 2px solid #3b82f6;
  }

  @keyframes fade-in-out {
    0% { opacity: 0; transform: translateY(-20px); }
    10% { opacity: 1; transform: translateY(0); }
    90% { opacity: 1; transform: translateY(0); }
    100% { opacity: 0; transform: translateY(-20px); }
  }
  
  .animate-fade-in-out {
    animation: fade-in-out 3s forwards;
  }
`,bt=({selectedNodes:h,visible:p,onClose:i})=>{const[j,y]=f.useState(0),[k,C]=f.useState({Steps:!0,CFG:!0,sampler_name:!0,threshold:!1,prompt:!1}),[I,L]=f.useState(!1),[$,_]=f.useState(!1),[Y,ue]=f.useState(0),[R,Le]=f.useState(12),[W,Me]=f.useState(null),[V,he]=f.useState(()=>Array(12).fill(null).map((t,r)=>({url:`https://source.unsplash.com/random/300x300?sig=${Math.random()}`,params:{step:r%3===0?5:r%3===1?10:15,sampler_name:"euler",cfg:1}}))),[g,J]=f.useState({}),[D,pe]=f.useState({}),[E,Te]=f.useState({}),[Ie,Q]=f.useState({}),[M,le]=f.useState(1),X=6,[Z,A]=f.useState(null),[$e,ge]=f.useState(!1),[De,fe]=f.useState(!1),[Ee,We]=f.useState(""),[B,z]=f.useState({}),[Ve,ee]=f.useState(!1),[ie,be]=f.useState(""),[ce,de]=f.useState([]),[je,xe]=f.useState(!1),[ye,Ae]=f.useState(""),[ve,Be]=f.useState(""),[we,te]=f.useState(null),[F,se]=f.useState({}),{dispatch:G}=nt(),Oe=async()=>{if(!ie.trim()){te("Please enter some text to generate variations");return}xe(!0),te(null),de([]),se({});try{const t=await at.generateSDPrompts(ie);de(t);const r={};t.forEach((a,o)=>{r[`text${o+1}`]=!1}),se(r)}catch(t){console.error("Error generating text:",t),te("Failed to generate text variations. Please try again.")}finally{xe(!1)}},_e=(t,r,a,o)=>{const s=`${t}_${r}`;z(c=>{const n=[...c[s]||[]];return n[a]=o,{...c,[s]:n}});const l=[...B[s]||[]];l[a]=o,P(t,r,l)},Re=(t,r)=>{const a=`${t}_${r}`;z(s=>{const l=[...s[a]||[]];return l.push(""),{...s,[a]:l}});const o=[...B[a]||[],""];P(t,r,o)},ze=(t,r,a)=>{const o=`${t}_${r}`;z(l=>{const c=[...l[o]||[]];return c.splice(a,1),{...l,[o]:c}});const s=[...B[o]||[]];s.splice(a,1),P(t,r,s)},Ne=t=>{se(r=>({...r,[t]:!r[t]}))},Fe=()=>{const t=`${ye}_${ve}`,r=Object.entries(F).filter(([o,s])=>s).map(([o])=>{const s=parseInt(o.replace("text",""))-1;return ce[s]});if(r.length===0)return;z(o=>{const s=[...o[t]||[]];return{...o,[t]:[...s,...r]}});const a=[...B[t]||[],...r];P(ye,ve,a),ee(!1)},Ge=(t,r)=>{ee(!0),Ae(t),Be(r),be(""),de([]),se({}),xe(!1),te(null)};f.useEffect(()=>{if(!h||h.length===0)return;const t={...g},r=h.map(o=>o.id.toString());Object.keys(t).forEach(o=>{r.includes(o)||delete t[o]}),h.forEach(o=>{const s=o.id.toString();t[s]||(t[s]={})}),JSON.stringify(t)!==JSON.stringify(g)&&J(t)},[h,g]),f.useEffect(()=>{G({type:"SET_SCREEN_STATE",payload:{currentScreen:j,isProcessing:I,isCompleted:$}})},[j,I,$,G]),f.useEffect(()=>{const t=document.createElement("style");return t.textContent=xt,document.head.appendChild(t),()=>{document.head.removeChild(t)}},[]),f.useEffect(()=>{const t=r=>{if(Object.values(D).some(a=>a)){const a=r.target,o=!!a.closest(".dropdown-menu"),s=!!a.closest("[data-dropdown]");!o&&!s&&pe({})}};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[D]);const He=Math.ceil(R/X),re=(t,r)=>{r&&(r.preventDefault(),r.stopPropagation()),le(Math.max(1,Math.min(t,He)))},ke=t=>{if(t&&(t.preventDefault(),t.stopPropagation()),j===1){const r=me();Le(r.length)}A(null),y(r=>Math.min(r+1,2))},ne=t=>{if(t&&(t.preventDefault(),t.stopPropagation()),A(null),$&&_(!1),j===1){const r=h.map(s=>s.id.toString()),a=Object.keys(g),o={...g};a.forEach(s=>{r.includes(s)||delete o[s]}),J(o)}y(r=>Math.max(r-1,0))},Ue=(t,r)=>{r&&(r.preventDefault(),r.stopPropagation()),C(a=>({...a,[t]:!a[t]}))},ae=(t,r,a,o=0)=>{t=isNaN(t)?0:t,r=isNaN(r)?100:r,a=isNaN(a)||a<=0?1:a,r<t&&(r=t);const s=Math.floor((r-t)/a)+1;if(s<=1)return[t];const l=[];let c=t;if(s<=10)for(;c<=r&&l.length<=10;){const n=Math.pow(10,o),u=Math.round(c*n)/n;l.push(u),c+=a}else{const u=(r-t)/9;for(let m=0;m<=9;m++){const x=t+u*m,d=Math.pow(10,o),v=Math.round(x*d)/d;l.push(v)}}return l},me=()=>{const t=[],r={};if(Object.keys(g).forEach(s=>{const l=parseInt(s),c=g[s]||{},n=Object.keys(c).filter(m=>c[m]&&c[m].length>0);if(n.length===0)return;const u=[[]];n.forEach(m=>{const x=c[m],d=[];u.forEach(v=>{x.forEach(S=>{const T=[...v,{nodeId:l,paramName:m,paramValue:String(S)}];d.push(T)})}),u.length=0,u.push(...d)}),r[s]=u}),Object.keys(r).length===0)return t;if(Object.keys(r).length===1){const s=Object.keys(r)[0];return r[s]}const a=Object.keys(r);let o=r[a[0]];for(let s=1;s<a.length;s++){const l=r[a[s]],c=[];o.forEach(n=>{l.forEach(u=>{c.push([...n,...u])})}),o=c}return o},qe=(t,r,a)=>{a.preventDefault(),a.stopPropagation();const o=`${t}_${r}`;pe(s=>{if(s[o]&&typeof s[o]=="object"?s[o].isOpen:!!s[o])return{...s,[o]:!1};{let c=0,n=0;if(a.currentTarget){const x=a.currentTarget.getBoundingClientRect();c=x.left,n=x.bottom}else c=a.clientX,n=a.clientY+20;const u=window.innerWidth,m=250;return c+m>u&&(c=u-m-10),c<0&&(c=10),{...s,[o]:{isOpen:!0,x:c,y:n}}}})},P=(t,r,a)=>{J(o=>{const s={...o};return s[t]||(s[t]={}),s[t][r]=a,s})},oe=(t,r,a,o)=>{o&&(o.preventDefault(),o.stopPropagation()),J(s=>{const l={...s};l[t]||(l[t]={}),l[t][r]||(l[t][r]=[]);const c=l[t][r];return c.includes(a)?l[t][r]=c.filter(n=>n!==a):l[t][r]=[...c,a],l})},Ke=(t,r,a)=>{const o=`${t}_${r}`;Te(s=>({...s,[o]:a}))},Ye=(t,r,a)=>{if(!g[t]){P(t,r,a);return}const o=g[t][r]||[];a.length===o.length?P(t,r,[]):P(t,r,[...a])},Je=(t,r)=>{const a={};a.nodeParams={};const o=me();return r<o.length&&o[r].forEach(l=>{const c=l.nodeId.toString(),n=l.paramName,u=l.paramValue;a.nodeParams[c]||(a.nodeParams[c]={}),a.nodeParams[c][n]=u,a[n]=u}),a},Ce=async t=>{t&&(t.preventDefault(),t.stopPropagation());const r=me(),a=r.length,o=ct();if(a>100){A(`Cannot generate more than 100 images at once (currently: ${a} images)`);return}if(A(null),L(!0),ue(0),console.log("Generated parameter combinations:",r),r.length===0){A("No valid parameter combinations found. Please check your parameter selections."),L(!1);return}const s=[];try{for(const m of r){const x=await lt(m);x.prompt_id?s.push(x.prompt_id):(console.error("Failed to get prompt_id from response:",x),s.push(""))}const l=Array(r.length).fill(null).map((m,x)=>({url:`https://source.unsplash.com/random/300x300?sig=${Math.random()}`,params:Je(g,x)}));he(l);const c=Date.now(),n=5*60*1e3,u=async()=>{if(Date.now()-c>n){console.log("Timeout reached while waiting for images"),L(!1),_(!0),le(1);return}let m=0;for(let x=0;x<s.length;x++){const d=s[x];if(d)try{const v=await dt(d,o);v&&(l[x]={...l[x],url:v},m++)}catch(v){console.error(`Error fetching image for prompt ID ${d}:`,v)}}he([...l]),ue(m),m===s.length||Date.now()-c>n?(L(!1),_(!0),le(1)):setTimeout(u,3e3)};u()}catch(l){console.error("Error generating images:",l),L(!1)}},Qe=(t,r)=>{r&&(r.preventDefault(),r.stopPropagation()),Me(t)},Xe=(t,r)=>{r.preventDefault(),r.stopPropagation(),We(t),fe(!0)},Pe=t=>{t&&(t.preventDefault(),t.stopPropagation()),fe(!1)},Ze=t=>{if(t&&(t.preventDefault(),t.stopPropagation()),W!==null){console.log(`Applied image ${W+1} with parameters:`,V[W].params);const r=V[W].params;r.nodeParams&&(Object.entries(r.nodeParams).forEach(([a,o])=>{const s=K.graph._nodes_by_id[a];!s||!s.widgets||Object.entries(o).forEach(([l,c])=>{for(const n of s.widgets)if(n.name===l){n.value=c;break}})}),K.graph.setDirtyCanvas(!1,!0),ge(!0),setTimeout(()=>{ge(!1)},3e3))}},O=(t,r)=>{if(t&&(t.preventDefault(),t.stopPropagation()),j===1&&r!==void 0){const a=[...h];a.splice(r,1),a.length===0?i&&(G({type:"SET_SCREEN_STATE",payload:null}),i()):G({type:"SET_SELECTED_NODE",payload:a});return}i?(G({type:"SET_SCREEN_STATE",payload:null}),i()):(y(0),_(!1),L(!1),A(null))};if(!p||h.length===0)return e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center p-8 bg-gray-50 overflow-y-auto",onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"max-w-lg p-8 bg-white rounded-lg shadow-sm border border-blue-100 relative",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h3",{className:"text-base font-bold text-blue-800 mb-2",children:"GenLab"}),e.jsx("div",{className:"h-1 w-16 bg-blue-500 mx-auto rounded-full mb-4"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-full text-blue-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-800",children:"Batch Test Parameter Pairs"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Select a node to batch test parameter pairs"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"bg-indigo-100 p-2 rounded-full text-indigo-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-800",children:"How To Use"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Click on any node in your workflow to start the parameter testing process"})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"No node is currently selected"})})]})]})});if($){const t=(M-1)*X,r=Math.min(t+X,V.length),a=V.slice(t,r),o=Math.ceil(V.length/X);return e.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-50 p-4",onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"mb-4 border-b pb-2 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium text-gray-800",children:"Generation Complete"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["All ",V.length," images have been generated."]})]}),e.jsx("button",{className:"text-gray-400 hover:text-gray-600",onClick:O,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),$e&&e.jsx("div",{className:"fixed top-4 right-4 bg-green-100 border-l-4 border-green-500 text-green-700 p-3 shadow-md rounded animate-fade-in-out z-50",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"py-1",children:e.jsx("svg",{className:"h-4 w-4 text-green-500 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("p",{className:"text-xs",children:"Parameters has been applied."})]})}),De&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",onClick:Pe,children:e.jsxs("div",{className:"bg-white rounded-lg p-2 max-w-4xl max-h-[90vh] relative",onClick:s=>s.stopPropagation(),children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-700 hover:text-gray-900 rounded-full hover:bg-gray-200 p-1",onClick:Pe,children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("div",{className:"overflow-auto max-h-[calc(90vh-4rem)]",children:e.jsx("img",{src:Ee,alt:"Enlarged image",className:"max-w-full h-auto"})})]})}),e.jsx("div",{className:"grid grid-cols-3 gap-4 mb-6",children:a.map((s,l)=>{const c=t+l;return e.jsxs("div",{className:`relative rounded-lg overflow-hidden border ${W===c?"border-pink-500 ring-2 ring-pink-300":"border-gray-200"}`,onClick:n=>Qe(c,n),children:[e.jsx("button",{className:"absolute top-2 right-2 bg-white bg-opacity-75 rounded-full p-0.5 text-gray-600 hover:text-gray-900 shadow-sm z-10",onClick:n=>Xe(s.url,n),children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5v-4m0 4h-4m4 0l-5-5"})})}),e.jsx("div",{className:"aspect-square",children:e.jsx("img",{src:s.url,alt:`Generated image ${c+1}`,className:"w-full h-full object-cover"})}),e.jsx("div",{className:"p-2 text-xs text-gray-600 bg-white max-h-16 overflow-y-auto",children:Object.entries(s.params).filter(([n,u])=>n!=="nodeParams"&&typeof u!="object").map(([n,u])=>e.jsxs("div",{children:[n,": ",String(u)]},n))})]},c)})}),o>1&&e.jsxs("div",{className:"flex justify-center items-center space-x-2 mt-4 mb-4",children:[e.jsx("button",{onClick:s=>re(1,s),disabled:M===1,className:`px-2 py-1 rounded ${M===1?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{fillRule:"evenodd",d:"M15.707 15.707a1 1 0 01-1.414 0l-5-5a1 1 0 010-1.414l5-5a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"}),e.jsx("path",{fillRule:"evenodd",d:"M8.707 15.707a1 1 0 01-1.414 0l-5-5a1 1 0 010-1.414l5-5a1 1 0 111.414 1.414L4.414 10l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})]})}),e.jsx("button",{onClick:s=>re(M-1,s),disabled:M===1,className:`px-2 py-1 rounded ${M===1?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"px-2 py-1 text-xs text-gray-800",children:["Page ",M," of ",o]}),e.jsx("button",{onClick:s=>re(M+1,s),disabled:M===o,className:`px-2 py-1 rounded ${M===o?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:s=>re(o,s),disabled:M===o,className:`px-2 py-1 rounded ${M===o?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{fillRule:"evenodd",d:"M4.293 15.707a1 1 0 001.414 0l5-5a1 1 0 000-1.414l-5-5a1 1 0 00-1.414 1.414L8.586 10 4.293 14.293a1 1 0 000 1.414z",clipRule:"evenodd"}),e.jsx("path",{fillRule:"evenodd",d:"M11.293 15.707a1 1 0 001.414 0l5-5a1 1 0 000-1.414l-5-5a1 1 0 00-1.414 1.414L15.586 10l-4.293 4.293a1 1 0 000 1.414z",clipRule:"evenodd"})]})})]}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx("button",{onClick:s=>ne(s),className:"px-3 py-1.5 text-xs bg-gray-100 text-gray-800 rounded-md hover:bg-gray-200 transition-colors",children:"Previous"}),e.jsx("button",{onClick:s=>Ze(s),className:"px-3 py-1.5 text-xs bg-pink-200 text-pink-700 rounded-md hover:bg-pink-300 transition-colors",disabled:W===null,children:"Apply Selected"})]})]})})}return I?e.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-50 p-4",onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gray-500 bg-opacity-30 flex flex-col items-center justify-center z-10",children:e.jsxs("div",{className:"text-center text-gray-800 bg-white p-4 rounded-lg shadow-lg",children:[e.jsx("div",{className:"mb-2 text-sm font-medium",children:"Processing..."}),e.jsxs("div",{className:"text-xs mb-3",children:["Completed ",Y," of ",R," runs"]}),e.jsx("div",{className:"w-48 h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-pink-500 transition-all duration-200",style:{width:`${Y/R*100}%`}})}),e.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["Already generated ",Y," images"]}),e.jsx("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),st({clear:!0}),rt(),L(!1),y(2)},className:"mt-4 px-3 py-1.5 text-xs bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"})]})}),e.jsxs("div",{className:"mb-4 border-b pb-2 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium text-gray-800",children:"Confirm Test Configuration"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["In the selected parameter combinations, there are ",R," total runs. Each run will generate a separate image."]})]}),e.jsx("button",{className:"text-gray-400 hover:text-gray-600",onClick:O,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Z&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-600 text-xs",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx("svg",{className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("div",{className:"ml-2",children:Z})]})}),h.length>0?h.map((t,r)=>{const a=t.type||"Unknown Node",o=t.widgets||[],s=t.id;return e.jsxs("div",{className:"border rounded-md mb-4 overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-3 py-2 text-xs font-medium text-gray-700 border-b",children:[a," (ID: ",s,")"]}),e.jsx("div",{className:"p-4 space-y-3",children:o.map((l,c)=>{const n=l.name;if(!k[n])return null;const u=g[s]?.[n]||[],m=Array.isArray(u)?`[${u.join(", ")}]`:JSON.stringify(u);return e.jsxs("div",{className:c<o.length-1?"flex justify-between items-center border-b pb-2":"flex justify-between items-center",children:[e.jsx("label",{className:"font-medium text-gray-700",children:n}),e.jsx("div",{className:"flex space-x-2 items-center",children:e.jsx("input",{type:"text",className:"w-64 h-7 border border-gray-300 rounded text-sm px-2 bg-gray-50 cursor-not-allowed text-gray-500",readOnly:!0,disabled:!0,value:m,onClick:x=>x.preventDefault()})})]},c)})})]},r)}):e.jsx("div",{className:"border rounded-md mb-4 p-4 text-center text-gray-500",children:"No nodes selected. Please select a node in the workflow to configure parameters."}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx("button",{onClick:t=>ne(t),className:"px-3 py-1.5 text-xs bg-gray-100 text-gray-800 rounded-md hover:bg-gray-200 transition-colors",children:"Previous"}),e.jsx("button",{onClick:t=>Ce(t),className:"px-3 py-1.5 text-xs bg-pink-200 text-pink-700 rounded-md hover:bg-pink-300 transition-colors",children:"Start Generation"})]})]})}):j===0?e.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-50 p-4",onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"mb-4 border-b pb-2 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium text-gray-800",children:"Select Parameters for Testing"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Choose the parameters you want to include in your batch test"})]}),e.jsx("button",{className:"text-gray-400 hover:text-gray-600",onClick:O,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),h.map((t,r)=>{const a=t.title||"Unknown Node",o=t.widgets||[];return e.jsxs("div",{className:"border rounded-md mb-4 overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 px-3 py-2 text-sm font-medium text-gray-700 border-b",children:a}),e.jsx("div",{className:"p-4 space-y-3",children:e.jsx("div",{className:"flex items-center gap-3 flex-wrap",children:o.map((s,l)=>{const c=s.name;return e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-5 h-5 rounded-full border flex items-center justify-center ${k[c]?"border-red-500 bg-red-100":"border-gray-300"}`,onClick:n=>Ue(c,n),children:k[c]&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"})}),e.jsx("span",{className:"ml-2 text-gray-700 text-xs",children:c})]},`widget-${l}`)})})})]},`node-${r}`)}),e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsx("button",{onClick:t=>ke(t),className:"px-3 py-1.5 text-xs bg-pink-200 text-pink-700 rounded-md hover:bg-pink-300 transition-colors",children:"Next"})})]})}):j===1?e.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-50 p-4",onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"mb-4 border-b pb-2 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium text-gray-800",children:"Parameter Options"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Configure the test values for each parameter"})]}),e.jsx("button",{className:"text-gray-400 hover:text-gray-600",onClick:O,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Ve&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium",children:"AI Writing Assistant"}),e.jsx("button",{className:"text-gray-400 hover:text-gray-600",onClick:()=>ee(!1),children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Enter text and AI will generate variations"}),e.jsx("textarea",{className:"w-full border border-gray-300 rounded-md p-2 text-sm",rows:3,placeholder:"Enter some text here...",value:ie,onChange:t=>be(t.target.value)}),e.jsx("button",{className:"mt-2 px-4 py-2 bg-blue-100 text-blue-700 rounded-md text-sm flex items-center hover:bg-blue-200 transition-colors",onClick:Oe,disabled:je,children:je?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-blue-700",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):e.jsx(e.Fragment,{children:"Generate"})})]}),we&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-600 text-sm",children:we}),ce.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Generated variations (select items to add):"}),e.jsx("div",{className:"space-y-2 max-h-[40vh] overflow-y-auto p-2",children:ce.map((t,r)=>e.jsxs("div",{className:"flex items-start border border-gray-200 rounded-md p-2",children:[e.jsx("div",{className:"mr-2 mt-1",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",id:`text${r+1}`,checked:!!F[`text${r+1}`],onChange:()=>Ne(`text${r+1}`),className:"sr-only"}),e.jsx("div",{className:`h-4 w-4 rounded border ${F[`text${r+1}`]?"bg-blue-600 border-blue-600":"bg-white border-gray-300"} flex items-center justify-center`,onClick:()=>Ne(`text${r+1}`),children:F[`text${r+1}`]&&e.jsx("svg",{className:"h-3 w-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]})}),e.jsx("label",{htmlFor:`text${r+1}`,className:"text-sm text-gray-700 cursor-pointer flex-1",children:t})]},r))})]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end",children:[e.jsx("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md text-sm mr-2 hover:bg-gray-200 transition-colors",onClick:()=>ee(!1),children:"Cancel"}),e.jsx("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-md text-sm hover:bg-blue-600 transition-colors",onClick:Fe,disabled:Object.values(F).every(t=>!t),children:"Add Selected"})]})]})}),h.length>0?h.map((t,r)=>{const a=t.widgets||{},o=Object.values(a),s=t.id;return e.jsxs("div",{className:"border rounded-md mb-4 overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-3 py-2 text-xs font-medium text-gray-700 border-b flex justify-between items-center",children:[e.jsxs("span",{children:[t.type," (ID: ",s,")"]}),e.jsx("button",{className:"text-gray-400 hover:text-gray-600",onClick:l=>O(l,r),children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-4 space-y-4",children:o.map((l,c)=>{const n=l.name;if(!k[n])return null;const u=`${s}_${n}`;if(l.type==="customtext"||l.type.toLowerCase().includes("text")){B[u]||(z(x=>({...x,[u]:[""]})),(!g[s]||!g[s][n])&&P(s,n,[""]));const m=B[u]||[""];return e.jsxs("div",{className:"border-b pb-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("label",{className:"text-xs font-medium text-gray-700",children:[n,":"]}),e.jsxs("button",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs flex items-center hover:bg-blue-200 transition-colors",onClick:()=>Ge(s,n),children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"AI Writing"]})]}),e.jsx("div",{className:"space-y-2",children:m.map((x,d)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx("textarea",{className:"flex-1 border border-gray-300 rounded p-2 text-xs resize-y",rows:2,placeholder:"Enter text...",value:x,onChange:v=>_e(s,n,d,v.target.value)}),e.jsx("button",{className:"ml-2 text-red-500 hover:text-red-700",onClick:()=>ze(s,n,d),title:"Remove",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},d))}),e.jsxs("button",{className:"mt-2 px-2 py-1 border border-dashed border-gray-300 rounded text-xs text-gray-600 hover:bg-gray-50 flex items-center",onClick:()=>Re(s,n),children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Text"]})]},c)}if(l.type==="number"){const m=l.options?.min||0,x=l.options?.max||100,d=(l.options?.step||10)/10,v=l.options?.precision||0,S=ae(m,x,d,v),T=Ie[u]||{min:m.toString(),max:x.toString(),step:d.toString()};return(!g[s]||!g[s][n])&&(P(s,n,S),Q(b=>({...b,[u]:T}))),e.jsxs("div",{className:"border-b pb-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("label",{className:"text-xs font-medium text-gray-700",children:[n,":"]}),e.jsx("div",{className:"w-4"})]}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Min"}),e.jsx("input",{type:"text",className:"w-12 h-6 border border-gray-300 rounded text-xs px-2",value:T.min,onClick:b=>{b.preventDefault(),b.stopPropagation()},onChange:b=>{b.preventDefault(),b.stopPropagation();const w=b.target.value;if(Q(N=>({...N,[u]:{...N[u],min:w}})),w===""||!isNaN(parseFloat(w))){const N=w===""?0:parseFloat(w),H=parseFloat(T.max||x.toString()),U=parseFloat(T.step||d.toString()),q=ae(N,H,U,v);P(s,n,q)}}}),e.jsx("label",{className:"text-xs text-gray-600",children:"Max"}),e.jsx("input",{type:"text",className:"w-12 h-6 border border-gray-300 rounded text-xs px-2",value:T.max,onClick:b=>{b.preventDefault(),b.stopPropagation()},onChange:b=>{b.preventDefault(),b.stopPropagation();const w=b.target.value;if(Q(N=>({...N,[u]:{...N[u],max:w}})),w===""||!isNaN(parseFloat(w))){const N=parseFloat(T.min||m.toString()),H=w===""?N:parseFloat(w),U=parseFloat(T.step||d.toString()),q=ae(N,H,U,v);P(s,n,q)}}}),e.jsx("label",{className:"text-xs text-gray-600",children:"Step"}),e.jsx("input",{type:"text",className:"w-12 h-6 border border-gray-300 rounded text-xs px-2",value:T.step,onClick:b=>{b.preventDefault(),b.stopPropagation()},onChange:b=>{b.preventDefault(),b.stopPropagation();const w=b.target.value;if(Q(N=>({...N,[u]:{...N[u],step:w}})),w===""||!isNaN(parseFloat(w))&&parseFloat(w)>0){const N=parseFloat(T.min||m.toString()),H=parseFloat(T.max||x.toString()),U=w===""?1:parseFloat(w),q=ae(N,H,U,v);P(s,n,q)}}})]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Test values"}),e.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:(g[s]?.[n]||S).map((b,w)=>e.jsxs("div",{className:"px-2 py-0.5 bg-blue-100 text-blue-800 rounded-md flex items-center text-xs cursor-pointer hover:bg-blue-200",onClick:N=>{N.stopPropagation(),oe(s,n,b,N)},children:[e.jsx("span",{children:b}),e.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]},w))})]}),e.jsx("div",{className:"mt-1",children:e.jsx("p",{className:"text-xs text-gray-500",children:"Values are distributed evenly between Min and Max (max 10 values)"})})]},c)}else if(l.type==="combo"){const m=l.options?.values||[],x=`${s}_${n}`;return(!g[s]||!g[s][n])&&P(s,n,m.slice(0,3)),e.jsxs("div",{className:"border-b pb-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{className:"text-xs font-medium text-gray-700",children:n}),e.jsxs("div",{className:"relative dropdown-container",children:[e.jsxs("button",{className:"appearance-none border border-gray-300 rounded px-2 py-0.5 pr-6 text-xs flex items-center bg-white text-gray-700",onClick:d=>{d.preventDefault(),d.stopPropagation(),qe(s,n,d)},"data-dropdown":x,children:[e.jsx("span",{children:(g[s]?.[n]||[]).length>0?`${n}: ${(g[s]?.[n]||[]).length} selected`:`Select ${n}`}),e.jsx("div",{className:"ml-2",children:e.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]}),D[x]&&e.jsxs("div",{className:"absolute z-[9999] mt-1 w-64 bg-white border border-gray-300 rounded-md shadow-lg dropdown-menu",style:{position:"fixed",top:typeof D[x]=="object"?`${D[x].y}px`:"0px",left:typeof D[x]=="object"?`${D[x].x}px`:"0px",maxHeight:"300px",overflowY:"auto"},children:[e.jsx("div",{className:"p-2 border-b sticky top-0 bg-white",children:e.jsx("input",{type:"text",className:"w-full px-2 py-0.5 text-xs border border-gray-300 rounded",placeholder:"Search...",value:E[x]||"",onChange:d=>{d.preventDefault(),d.stopPropagation(),Ke(s,n,d.target.value)},onClick:d=>{d.preventDefault(),d.stopPropagation()},autoFocus:!0})}),e.jsxs("div",{className:"px-3 py-1.5 bg-gray-50 border-b cursor-pointer text-xs flex items-center text-gray-700 hover:bg-gray-100",onClick:d=>{d.preventDefault(),d.stopPropagation();const v=m.filter(S=>!E[x]||S.toLowerCase().includes((E[x]||"").toLowerCase()));Ye(s,n,v)},children:[e.jsx("div",{className:`w-4 h-4 mr-2 border rounded-sm flex items-center justify-center ${m.length>0&&(g[s]?.[n]||[]).length===m.length?"bg-blue-500 border-blue-500":(g[s]?.[n]||[]).length>0?"bg-blue-500 border-blue-500 opacity-50":"border-gray-300"}`,children:(g[s]?.[n]||[]).length>0&&e.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("span",{className:"font-medium",children:m.length>0&&(g[s]?.[n]||[]).length===m.length?"Deselect All":"Select All"})]}),e.jsxs("div",{className:"max-h-60 overflow-y-auto",children:[m.filter(d=>!E[x]||d.toLowerCase().includes((E[x]||"").toLowerCase())).map((d,v)=>e.jsxs("div",{className:"px-3 py-1.5 hover:bg-gray-100 cursor-pointer text-xs flex items-center text-gray-700",onClick:S=>{S.preventDefault(),S.stopPropagation(),oe(s,n,d,S)},children:[e.jsx("div",{className:`w-4 h-4 mr-2 border rounded-sm flex items-center justify-center ${(g[s]?.[n]||[]).includes(d)?"bg-blue-500 border-blue-500":"border-gray-300"}`,children:(g[s]?.[n]||[]).includes(d)&&e.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("span",{className:"whitespace-normal overflow-hidden text-ellipsis",children:d})]},v)),m.filter(d=>!E[x]||d.toLowerCase().includes((E[x]||"").toLowerCase())).length===0&&e.jsx("div",{className:"px-3 py-4 text-sm text-gray-500 text-center",children:"No matching options"})]})]})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Test values"}),e.jsxs("div",{className:"mt-1 flex flex-wrap gap-1",children:[(g[s]?.[n]||[]).map((d,v)=>e.jsxs("div",{className:"px-2 py-0.5 bg-blue-100 text-blue-800 rounded-md flex items-center text-xs",children:[e.jsx("span",{children:d}),e.jsx("svg",{className:"w-4 h-4 ml-1 cursor-pointer hover:text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:S=>{S.preventDefault(),S.stopPropagation(),oe(s,n,d,S)},children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]},v)),e.jsxs("button",{className:"px-2 py-0.5 border border-dashed border-blue-300 text-blue-600 rounded-md text-xs flex items-center hover:bg-blue-50",onClick:d=>{d.preventDefault(),d.stopPropagation();const v=`${n}${(g[s]?.[n]||[]).length+1}`;P(s,n,[...g[s]?.[n]||[],v])},children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),e.jsx("span",{children:"Add"})]})]})]})]},c)}else return(!g[s]||!g[s][n])&&P(s,n,[`${n}1`,`${n}2`,`${n}3`]),e.jsxs("div",{className:"border-b pb-3",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("label",{className:"text-xs font-medium text-gray-700",children:n})}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Test values"}),e.jsxs("div",{className:"mt-1 flex flex-wrap gap-1",children:[(g[s]?.[n]||[]).map((m,x)=>e.jsxs("div",{className:"px-2 py-0.5 bg-blue-100 text-blue-800 rounded-md flex items-center text-xs",children:[e.jsx("span",{children:m}),e.jsx("svg",{className:"w-4 h-4 ml-1 cursor-pointer hover:text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:d=>{d.preventDefault(),d.stopPropagation(),oe(s,n,m,d)},children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]},x)),e.jsxs("button",{className:"px-2 py-0.5 border border-dashed border-blue-300 text-blue-600 rounded-md text-xs flex items-center hover:bg-blue-50",onClick:m=>{m.preventDefault(),m.stopPropagation();const x=`${n}${(g[s]?.[n]||[]).length+1}`;P(s,n,[...g[s]?.[n]||[],x])},children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),e.jsx("span",{children:"Add"})]})]})]})]},c)})})]},r)}):e.jsx("div",{className:"border rounded-md mb-4 p-4 text-center text-gray-500",children:"No nodes selected. Please select a node in the workflow to configure parameters."}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx("button",{onClick:t=>ne(t),className:"px-3 py-1.5 text-xs bg-gray-100 text-gray-800 rounded-md hover:bg-gray-200 transition-colors",children:"Previous"}),e.jsx("button",{onClick:t=>ke(t),className:"px-3 py-1.5 text-xs bg-pink-200 text-pink-700 rounded-md hover:bg-pink-300 transition-colors",children:"Next"})]})]})}):e.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-50 p-4",onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"mb-4 border-b pb-2 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium text-gray-800",children:"Confirm Test Configuration"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["In the selected parameter combinations, there are ",R," total runs. Each run will generate a separate image."]})]}),e.jsx("button",{className:"text-gray-400 hover:text-gray-600",onClick:O,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Z&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-600 text-xs",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx("svg",{className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("div",{className:"ml-2",children:Z})]})}),h.length>0?h.map((t,r)=>{const a=t.type||"Unknown Node",o=t.widgets||[],s=t.id;return e.jsxs("div",{className:"border rounded-md mb-4 overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-3 py-2 text-xs font-medium text-gray-700 border-b",children:[a," (ID: ",s,")"]}),e.jsx("div",{className:"p-4 space-y-3",children:o.map((l,c)=>{const n=l.name;if(!k[n])return null;const u=g[s]?.[n]||[],m=Array.isArray(u)?`[${u.join(", ")}]`:JSON.stringify(u);return e.jsxs("div",{className:c<o.length-1?"flex justify-between items-center border-b pb-2":"flex justify-between items-center",children:[e.jsx("label",{className:"font-medium text-gray-700 text-xs",children:n}),e.jsx("div",{className:"flex space-x-2 items-center",children:e.jsx("input",{type:"text",className:"w-64 h-7 border border-gray-300 rounded text-xs px-2 bg-gray-50 cursor-not-allowed text-gray-500",readOnly:!0,disabled:!0,value:m,onClick:x=>x.preventDefault()})})]},c)})})]},r)}):e.jsx("div",{className:"border rounded-md mb-4 p-4 text-center text-gray-500 text-xs",children:"No nodes selected. Please select a node in the workflow to configure parameters."}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx("button",{onClick:t=>ne(t),className:"px-3 py-1.5 text-xs bg-gray-100 text-gray-800 rounded-md hover:bg-gray-200 transition-colors",children:"Previous"}),e.jsx("button",{onClick:t=>Ce(t),className:"px-3 py-1.5 text-xs bg-pink-200 text-pink-700 rounded-md hover:bg-pink-300 transition-colors",children:"Start Generation"})]})]})})};export{bt as ParameterDebugInterface};
