import{j as e}from"./vendor-markdown-Dek94WS0.js";import{r as g}from"./vendor-react-V04_Axys.js";import{r as et,g as tt,a as st,m as rt,i as at}from"./workflowChat-m6G7RPl1.js";import{a as ne,u as nt,W as ot}from"./message-components-B3k4U96-.js";import"./input.js";import"./App-DFyVplDL.js";function lt(u,b){try{if(!u)return console.error("Invalid prompt_output: ",u),u;for(const p of b){if(!u[p.nodeId]){console.error(`Node with ID ${p.nodeId} not found`);continue}if(!u[p.nodeId].inputs){console.error(`Inputs not found for node with ID ${p.nodeId}`);continue}u[p.nodeId].inputs[p.paramName]=p.paramValue}return u}catch(p){return console.error("Error updating prompt:",p),u}}async function it(u){const b=await ne.graphToPrompt(),p=lt(b.output,u);console.log("queuePrompt updated_prompt:",p);const N={prompt:p,client_id:ne.api.clientId,extra_data:{extra_pageinfo:{workflow:b.workflow}}};console.debug("queuePrompt request_body.prompt:",p);const v=await et(N);return console.debug("queuePrompt response:",v),v}function Le(u){const b=document.createElement("canvas"),p=b.getContext("2d"),N=512,v=512;return b.width=N,b.height=v,p&&(p.fillStyle="red",p.font="20px Arial",p.fillText(u,10,30)),new Blob([b.toDataURL("image/png")],{type:"image/png"})}async function ct(u){try{if(!u||u==="")return console.log("No prompt ID provided"),{1:[Le("Fail to generate prompt ID")]};const b=await tt(u);if(!b||!b[u])return console.log("Not finished for prompt ID:",u),{};const p=b[u];if(p.status&&p.status.status_str==="error"){console.error("Error for prompt ID:",u);const v=p.status.messages;if(v&&v.length>0){const P=v[v.length-1];if(P&&P.length>0){const E=P[0];return{1:[Le(E)]}}}}const N={};if(p.outputs)for(const v in p.outputs){const P=p.outputs[v];if(P.images){const E=[];for(const T of P.images){const M=await st(T.filename,T.subfolder,T.type);E.push(M)}N[v]=E}}return N}catch(b){throw console.error("Error getting output images from prompt:",b),b}}async function dt(u){const b=await ct(u);if(Object.keys(b).length===0)return[];const p=Object.keys(b).map(v=>parseInt(v)),N=Math.max(...p).toString();return b[N]||[]}const xt=`
  @keyframes highlight-pulse {
    0% { 
      box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.5);
    }
    70% { 
      box-shadow: 0 0 0 15px rgba(59, 130, 246, 0);
    }
    100% { 
      box-shadow: 0 0 0 0 rgba(59, 130, 246, 0);
    }
  }
  
  .highlight-pulse {
    animation: highlight-pulse 1.5s infinite;
    border: 2px solid #3b82f6;
  }

  @keyframes fade-in-out {
    0% { opacity: 0; transform: translateY(-20px); }
    10% { opacity: 1; transform: translateY(0); }
    90% { opacity: 1; transform: translateY(0); }
    100% { opacity: 0; transform: translateY(-20px); }
  }
  
  .animate-fade-in-out {
    animation: fade-in-out 3s forwards;
  }
`,bt=({selectedNodes:u,visible:b,onClose:p})=>{const[N,v]=g.useState(0),[P,E]=g.useState({Steps:!0,CFG:!0,sampler_name:!0,threshold:!1,prompt:!1}),[T,M]=g.useState(!1),[U,q]=g.useState(!1),[oe,ue]=g.useState(0),[O,Se]=g.useState(12),[I,Me]=g.useState(null),[W,he]=g.useState(()=>Array(12).fill(null).map((t,r)=>({url:`https://source.unsplash.com/random/300x300?sig=${Math.random()}`,params:{step:r%3===0?5:r%3===1?10:15,sampler_name:"euler",cfg:1}}))),[h,K]=g.useState({}),[$,pe]=g.useState({}),[D,Te]=g.useState({}),[$e,Y]=g.useState({}),[L,le]=g.useState(1),J=6,[Q,V]=g.useState(null),[De,ge]=g.useState(!1),[Ee,fe]=g.useState(!1),[Ie,We]=g.useState(""),[A,_]=g.useState({}),[Ve,X]=g.useState(!1),[ie,be]=g.useState(""),[ce,de]=g.useState([]),[je,xe]=g.useState(!1),[ye,Ae]=g.useState(""),[ve,Be]=g.useState(""),[we,Z]=g.useState(null),[z,ee]=g.useState({}),{dispatch:R}=nt(),Oe=async()=>{if(!ie.trim()){Z("Please enter some text to generate variations");return}xe(!0),Z(null),de([]),ee({});try{const t=await ot.generateSDPrompts(ie);de(t);const r={};t.forEach((o,n)=>{r[`text${n+1}`]=!1}),ee(r)}catch(t){console.error("Error generating text:",t),Z("Failed to generate text variations. Please try again.")}finally{xe(!1)}},_e=(t,r,o,n)=>{const s=`${t}_${r}`;_(i=>{const l=[...i[s]||[]];return l[o]=n,{...i,[s]:l}}),k(t,r,A[s]||[])},ze=(t,r)=>{const o=`${t}_${r}`;_(s=>{const i=[...s[o]||[]];return i.push(""),{...s,[o]:i}});const n=[...A[o]||[],""];k(t,r,n)},Re=(t,r,o)=>{const n=`${t}_${r}`;_(i=>{const l=[...i[n]||[]];return l.splice(o,1),{...i,[n]:l}});const s=[...A[n]||[]];s.splice(o,1),k(t,r,s)},Ne=t=>{ee(r=>({...r,[t]:!r[t]}))},Fe=()=>{const t=`${ye}_${ve}`,r=Object.entries(z).filter(([n,s])=>s).map(([n])=>{const s=parseInt(n.replace("text",""))-1;return ce[s]});if(r.length===0)return;_(n=>{const s=[...n[t]||[]];return{...n,[t]:[...s,...r]}});const o=[...A[t]||[],...r];k(ye,ve,o),X(!1)},Ge=(t,r)=>{X(!0),Ae(t),Be(r),be(""),de([]),ee({}),xe(!1),Z(null)};g.useEffect(()=>{if(!u||u.length===0)return;const t={...h},r=u.map(n=>n.id.toString());Object.keys(t).forEach(n=>{r.includes(n)||delete t[n]}),u.forEach(n=>{const s=n.id.toString();t[s]||(t[s]={})}),JSON.stringify(t)!==JSON.stringify(h)&&K(t)},[u,h]),g.useEffect(()=>{R({type:"SET_SCREEN_STATE",payload:{currentScreen:N,isProcessing:T,isCompleted:U}})},[N,T,U,R]),g.useEffect(()=>{const t=document.createElement("style");return t.textContent=xt,document.head.appendChild(t),()=>{document.head.removeChild(t)}},[]),g.useEffect(()=>{const t=r=>{if(Object.values($).some(o=>o)){const o=r.target,n=!!o.closest(".dropdown-menu"),s=!!o.closest("[data-dropdown]");!n&&!s&&pe({})}};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[$]);const He=Math.ceil(O/J),te=(t,r)=>{r&&(r.preventDefault(),r.stopPropagation()),le(Math.max(1,Math.min(t,He)))},ke=t=>{if(t&&(t.preventDefault(),t.stopPropagation()),N===1){const r=me();Se(r.length)}V(null),v(r=>Math.min(r+1,2))},se=t=>{if(t&&(t.preventDefault(),t.stopPropagation()),V(null),U&&q(!1),N===1){const r=u.map(s=>s.id.toString()),o=Object.keys(h),n={...h};o.forEach(s=>{r.includes(s)||delete n[s]}),K(n)}v(r=>Math.max(r-1,0))},Ue=(t,r)=>{r&&(r.preventDefault(),r.stopPropagation()),E(o=>({...o,[t]:!o[t]}))},re=(t,r,o,n=0)=>{t=isNaN(t)?0:t,r=isNaN(r)?100:r,o=isNaN(o)||o<=0?1:o,r<t&&(r=t);const s=Math.floor((r-t)/o)+1;if(s<=1)return[t];const i=[];let l=t;if(s<=10)for(;l<=r&&i.length<=10;){const a=Math.pow(10,n),x=Math.round(l*a)/a;i.push(x),l+=o}else{const x=(r-t)/9;for(let d=0;d<=9;d++){const m=t+x*d,c=Math.pow(10,n),j=Math.round(m*c)/c;i.push(j)}}return i},me=()=>{const t=[],r={};if(Object.keys(h).forEach(s=>{const i=parseInt(s),l=h[s]||{},a=Object.keys(l).filter(d=>l[d]&&l[d].length>0);if(a.length===0)return;const x=[[]];a.forEach(d=>{const m=l[d],c=[];x.forEach(j=>{m.forEach(C=>{const S=[...j,{nodeId:i,paramName:d,paramValue:String(C)}];c.push(S)})}),x.length=0,x.push(...c)}),r[s]=x}),Object.keys(r).length===0)return t;if(Object.keys(r).length===1){const s=Object.keys(r)[0];return r[s]}const o=Object.keys(r);let n=r[o[0]];for(let s=1;s<o.length;s++){const i=r[o[s]],l=[];n.forEach(a=>{i.forEach(x=>{l.push([...a,...x])})}),n=l}return n},qe=(t,r,o)=>{o.preventDefault(),o.stopPropagation();const n=`${t}_${r}`;pe(s=>{if(s[n]&&typeof s[n]=="object"?s[n].isOpen:!!s[n])return{...s,[n]:!1};{let l=0,a=0;if(o.currentTarget){const m=o.currentTarget.getBoundingClientRect();l=m.left,a=m.bottom}else l=o.clientX,a=o.clientY+20;const x=window.innerWidth,d=250;return l+d>x&&(l=x-d-10),l<0&&(l=10),{...s,[n]:{isOpen:!0,x:l,y:a}}}})},k=(t,r,o)=>{K(n=>{const s={...n};return s[t]||(s[t]={}),s[t][r]=o,s})},ae=(t,r,o,n)=>{n&&(n.preventDefault(),n.stopPropagation()),K(s=>{const i={...s};i[t]||(i[t]={}),i[t][r]||(i[t][r]=[]);const l=i[t][r];return l.includes(o)?i[t][r]=l.filter(a=>a!==o):i[t][r]=[...l,o],i})},Ke=(t,r,o)=>{const n=`${t}_${r}`;Te(s=>({...s,[n]:o}))},Ye=(t,r,o)=>{if(!h[t]){k(t,r,o);return}const n=h[t][r]||[];o.length===n.length?k(t,r,[]):k(t,r,[...o])},Je=(t,r)=>{const o={};o.nodeParams={};const n=me();return r<n.length&&n[r].forEach(i=>{const l=i.nodeId.toString(),a=i.paramName,x=i.paramValue;o.nodeParams[l]||(o.nodeParams[l]={}),o.nodeParams[l][a]=x,o[a]=x}),o},Ce=async t=>{t&&(t.preventDefault(),t.stopPropagation());const r=me(),o=r.length;if(o>20){V(`Cannot generate more than 20 images at once (currently: ${o} images)`);return}if(V(null),M(!0),ue(0),console.log("Generated parameter combinations:",r),r.length===0){V("No valid parameter combinations found. Please check your parameter selections."),M(!1);return}const n=[];try{for(const x of r){const d=await it(x);d.prompt_id?n.push(d.prompt_id):(console.error("Failed to get prompt_id from response:",d),n.push(""))}const s=Array(r.length).fill(null).map((x,d)=>({url:`https://source.unsplash.com/random/300x300?sig=${Math.random()}`,params:Je(h,d)}));he(s);const i=Date.now(),l=5*60*1e3,a=async()=>{if(Date.now()-i>l){console.log("Timeout reached while waiting for images"),M(!1),q(!0),le(1);return}let x=0;for(let d=0;d<n.length;d++){const m=n[d];if(m)try{const c=await dt(m);if(c&&c.length>0){const j=URL.createObjectURL(c[0]);s[d]={...s[d],url:j},x++}}catch(c){console.error(`Error fetching image for prompt ID ${m}:`,c)}}he([...s]),ue(x),x===n.length||Date.now()-i>l?(M(!1),q(!0),le(1)):setTimeout(a,3e3)};a()}catch(s){console.error("Error generating images:",s),M(!1)}},Qe=(t,r)=>{r&&(r.preventDefault(),r.stopPropagation()),Me(t)},Xe=(t,r)=>{r.preventDefault(),r.stopPropagation(),We(t),fe(!0)},Pe=t=>{t&&(t.preventDefault(),t.stopPropagation()),fe(!1)},Ze=t=>{if(t&&(t.preventDefault(),t.stopPropagation()),I!==null){console.log(`Applied image ${I+1} with parameters:`,W[I].params);const r=W[I].params;r.nodeParams&&(Object.entries(r.nodeParams).forEach(([o,n])=>{const s=ne.graph._nodes_by_id[o];!s||!s.widgets||Object.entries(n).forEach(([i,l])=>{for(const a of s.widgets)if(a.name===i){a.value=l;break}})}),ne.graph.setDirtyCanvas(!1,!0),ge(!0),setTimeout(()=>{ge(!1)},3e3))}},B=(t,r)=>{if(t&&(t.preventDefault(),t.stopPropagation()),N===1&&r!==void 0){const o=[...u];o.splice(r,1),o.length===0?p&&(R({type:"SET_SCREEN_STATE",payload:null}),p()):R({type:"SET_SELECTED_NODE",payload:o});return}p?(R({type:"SET_SCREEN_STATE",payload:null}),p()):(v(0),q(!1),M(!1),V(null))};if(!b||u.length===0)return e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center p-8 bg-gray-50 overflow-y-auto",onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"max-w-lg p-8 bg-white rounded-lg shadow-sm border border-blue-100 relative",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h3",{className:"text-base font-bold text-blue-800 mb-2",children:"GenLab"}),e.jsx("div",{className:"h-1 w-16 bg-blue-500 mx-auto rounded-full mb-4"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-full text-blue-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-800",children:"Batch Test Parameter Pairs"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Select a node to batch test parameter pairs"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"bg-indigo-100 p-2 rounded-full text-indigo-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-800",children:"How To Use"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Click on any node in your workflow to start the parameter testing process"})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"No node is currently selected"})})]})]})});if(U){const t=(L-1)*J,r=Math.min(t+J,W.length),o=W.slice(t,r),n=Math.ceil(W.length/J);return e.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-50 p-4",onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"mb-4 border-b pb-2 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium text-gray-800",children:"Generation Complete"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["All ",W.length," images have been generated."]})]}),e.jsx("button",{className:"text-gray-400 hover:text-gray-600",onClick:B,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),De&&e.jsx("div",{className:"fixed top-4 right-4 bg-green-100 border-l-4 border-green-500 text-green-700 p-3 shadow-md rounded animate-fade-in-out z-50",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"py-1",children:e.jsx("svg",{className:"h-4 w-4 text-green-500 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("p",{className:"text-xs",children:"Parameters has been applied."})]})}),Ee&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",onClick:Pe,children:e.jsxs("div",{className:"bg-white rounded-lg p-2 max-w-4xl max-h-[90vh] relative",onClick:s=>s.stopPropagation(),children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-700 hover:text-gray-900 rounded-full hover:bg-gray-200 p-1",onClick:Pe,children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("div",{className:"overflow-auto max-h-[calc(90vh-4rem)]",children:e.jsx("img",{src:Ie,alt:"Enlarged image",className:"max-w-full h-auto"})})]})}),e.jsx("div",{className:"grid grid-cols-3 gap-4 mb-6",children:o.map((s,i)=>{const l=t+i;return e.jsxs("div",{className:`relative rounded-lg overflow-hidden border ${I===l?"border-pink-500 ring-2 ring-pink-300":"border-gray-200"}`,onClick:a=>Qe(l,a),children:[e.jsx("button",{className:"absolute top-2 right-2 bg-white bg-opacity-75 rounded-full p-0.5 text-gray-600 hover:text-gray-900 shadow-sm z-10",onClick:a=>Xe(s.url,a),children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5v-4m0 4h-4m4 0l-5-5"})})}),e.jsx("div",{className:"aspect-square",children:e.jsx("img",{src:s.url,alt:`Generated image ${l+1}`,className:"w-full h-full object-cover"})}),e.jsx("div",{className:"p-2 text-xs text-gray-600 bg-white max-h-24 overflow-y-auto",children:Object.entries(s.params).filter(([a,x])=>a!=="nodeParams"&&typeof x!="object").map(([a,x])=>e.jsxs("div",{children:[a,": ",String(x)]},a))})]},l)})}),n>1&&e.jsxs("div",{className:"flex justify-center items-center space-x-2 mt-4 mb-4",children:[e.jsx("button",{onClick:s=>te(1,s),disabled:L===1,className:`px-2 py-1 rounded ${L===1?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{fillRule:"evenodd",d:"M15.707 15.707a1 1 0 01-1.414 0l-5-5a1 1 0 010-1.414l5-5a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"}),e.jsx("path",{fillRule:"evenodd",d:"M8.707 15.707a1 1 0 01-1.414 0l-5-5a1 1 0 010-1.414l5-5a1 1 0 111.414 1.414L4.414 10l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})]})}),e.jsx("button",{onClick:s=>te(L-1,s),disabled:L===1,className:`px-2 py-1 rounded ${L===1?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"px-2 py-1 text-xs text-gray-800",children:["Page ",L," of ",n]}),e.jsx("button",{onClick:s=>te(L+1,s),disabled:L===n,className:`px-2 py-1 rounded ${L===n?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:s=>te(n,s),disabled:L===n,className:`px-2 py-1 rounded ${L===n?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{fillRule:"evenodd",d:"M4.293 15.707a1 1 0 001.414 0l5-5a1 1 0 000-1.414l-5-5a1 1 0 00-1.414 1.414L8.586 10 4.293 14.293a1 1 0 000 1.414z",clipRule:"evenodd"}),e.jsx("path",{fillRule:"evenodd",d:"M11.293 15.707a1 1 0 001.414 0l5-5a1 1 0 000-1.414l-5-5a1 1 0 00-1.414 1.414L15.586 10l-4.293 4.293a1 1 0 000 1.414z",clipRule:"evenodd"})]})})]}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx("button",{onClick:s=>se(s),className:"px-3 py-1.5 text-xs bg-gray-100 text-gray-800 rounded-md hover:bg-gray-200 transition-colors",children:"Previous"}),e.jsx("button",{onClick:s=>Ze(s),className:"px-3 py-1.5 text-xs bg-pink-200 text-pink-700 rounded-md hover:bg-pink-300 transition-colors",disabled:I===null,children:"Apply Selected"})]})]})})}return T?e.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-50 p-4",onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gray-500 bg-opacity-30 flex flex-col items-center justify-center z-10",children:e.jsxs("div",{className:"text-center text-gray-800 bg-white p-4 rounded-lg shadow-lg",children:[e.jsx("div",{className:"mb-2 text-sm font-medium",children:"Processing..."}),e.jsxs("div",{className:"text-xs mb-3",children:["Completed ",oe," of ",O," runs"]}),e.jsx("div",{className:"w-48 h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-pink-500 transition-all duration-200",style:{width:`${oe/O*100}%`}})}),e.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["Already generated ",oe," images"]}),e.jsx("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),rt({clear:!0}),at(),M(!1),v(2)},className:"mt-4 px-3 py-1.5 text-xs bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"})]})}),e.jsxs("div",{className:"mb-4 border-b pb-2 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium text-gray-800",children:"Confirm Test Configuration"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["In the selected parameter combinations, there are ",O," total runs. Each run will generate a separate image."]})]}),e.jsx("button",{className:"text-gray-400 hover:text-gray-600",onClick:B,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Q&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-600 text-xs",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx("svg",{className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("div",{className:"ml-2",children:Q})]})}),u.length>0?u.map((t,r)=>{const o=t.type||"Unknown Node",n=t.widgets||[],s=t.id;return e.jsxs("div",{className:"border rounded-md mb-4 overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-3 py-2 text-xs font-medium text-gray-700 border-b",children:[o," (ID: ",s,")"]}),e.jsx("div",{className:"p-4 space-y-3",children:n.map((i,l)=>{const a=i.name;if(!P[a])return null;const x=h[s]?.[a]||[],d=Array.isArray(x)?`[${x.join(", ")}]`:JSON.stringify(x);return e.jsxs("div",{className:l<n.length-1?"flex justify-between items-center border-b pb-2":"flex justify-between items-center",children:[e.jsx("label",{className:"font-medium text-gray-700",children:a}),e.jsx("div",{className:"flex space-x-2 items-center",children:e.jsx("input",{type:"text",className:"w-64 h-7 border border-gray-300 rounded text-sm px-2 bg-gray-50 cursor-not-allowed text-gray-500",readOnly:!0,disabled:!0,value:d,onClick:m=>m.preventDefault()})})]},l)})})]},r)}):e.jsx("div",{className:"border rounded-md mb-4 p-4 text-center text-gray-500",children:"No nodes selected. Please select a node in the workflow to configure parameters."}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx("button",{onClick:t=>se(t),className:"px-3 py-1.5 text-xs bg-gray-100 text-gray-800 rounded-md hover:bg-gray-200 transition-colors",children:"Previous"}),e.jsx("button",{onClick:t=>Ce(t),className:"px-3 py-1.5 text-xs bg-pink-200 text-pink-700 rounded-md hover:bg-pink-300 transition-colors",children:"Start Generation"})]})]})}):N===0?e.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-50 p-4",onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"mb-4 border-b pb-2 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium text-gray-800",children:"Select Parameters for Testing"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Choose the parameters you want to include in your batch test"})]}),e.jsx("button",{className:"text-gray-400 hover:text-gray-600",onClick:B,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.map((t,r)=>{const o=t.title||"Unknown Node",n=t.widgets||[];return e.jsxs("div",{className:"border rounded-md mb-4 overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 px-3 py-2 text-sm font-medium text-gray-700 border-b",children:o}),e.jsx("div",{className:"p-4 space-y-3",children:e.jsx("div",{className:"flex items-center gap-3 flex-wrap",children:n.map((s,i)=>{const l=s.name;return e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-5 h-5 rounded-full border flex items-center justify-center ${P[l]?"border-red-500 bg-red-100":"border-gray-300"}`,onClick:a=>Ue(l,a),children:P[l]&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"})}),e.jsx("span",{className:"ml-2 text-gray-700 text-xs",children:l})]},`widget-${i}`)})})})]},`node-${r}`)}),e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsx("button",{onClick:t=>ke(t),className:"px-3 py-1.5 text-xs bg-pink-200 text-pink-700 rounded-md hover:bg-pink-300 transition-colors",children:"Next"})})]})}):N===1?e.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-50 p-4",onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"mb-4 border-b pb-2 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium text-gray-800",children:"Parameter Options"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Configure the test values for each parameter"})]}),e.jsx("button",{className:"text-gray-400 hover:text-gray-600",onClick:B,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Ve&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium",children:"AI Writing Assistant"}),e.jsx("button",{className:"text-gray-400 hover:text-gray-600",onClick:()=>X(!1),children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Enter text and AI will generate variations"}),e.jsx("textarea",{className:"w-full border border-gray-300 rounded-md p-2 text-sm",rows:3,placeholder:"Enter some text here...",value:ie,onChange:t=>be(t.target.value)}),e.jsx("button",{className:"mt-2 px-4 py-2 bg-blue-100 text-blue-700 rounded-md text-sm flex items-center hover:bg-blue-200 transition-colors",onClick:Oe,disabled:je,children:je?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-blue-700",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):e.jsx(e.Fragment,{children:"Generate"})})]}),we&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-600 text-sm",children:we}),ce.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Generated variations (select items to add):"}),e.jsx("div",{className:"space-y-2 max-h-[40vh] overflow-y-auto p-2",children:ce.map((t,r)=>e.jsxs("div",{className:"flex items-start border border-gray-200 rounded-md p-2",children:[e.jsx("div",{className:"mr-2 mt-1",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",id:`text${r+1}`,checked:!!z[`text${r+1}`],onChange:()=>Ne(`text${r+1}`),className:"sr-only"}),e.jsx("div",{className:`h-4 w-4 rounded border ${z[`text${r+1}`]?"bg-blue-600 border-blue-600":"bg-white border-gray-300"} flex items-center justify-center`,onClick:()=>Ne(`text${r+1}`),children:z[`text${r+1}`]&&e.jsx("svg",{className:"h-3 w-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]})}),e.jsx("label",{htmlFor:`text${r+1}`,className:"text-sm text-gray-700 cursor-pointer flex-1",children:t})]},r))})]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end",children:[e.jsx("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md text-sm mr-2 hover:bg-gray-200 transition-colors",onClick:()=>X(!1),children:"Cancel"}),e.jsx("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-md text-sm hover:bg-blue-600 transition-colors",onClick:Fe,disabled:Object.values(z).every(t=>!t),children:"Add Selected"})]})]})}),u.length>0?u.map((t,r)=>{const o=t.widgets||{},n=Object.values(o),s=t.id;return e.jsxs("div",{className:"border rounded-md mb-4 overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-3 py-2 text-xs font-medium text-gray-700 border-b flex justify-between items-center",children:[e.jsxs("span",{children:[t.type," (ID: ",s,")"]}),e.jsx("button",{className:"text-gray-400 hover:text-gray-600",onClick:i=>B(i,r),children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-4 space-y-4",children:n.map((i,l)=>{const a=i.name;if(!P[a])return null;const x=`${s}_${a}`;if(i.type==="customtext"||i.type.toLowerCase().includes("text")){A[x]||(_(m=>({...m,[x]:[""]})),(!h[s]||!h[s][a])&&k(s,a,[""]));const d=A[x]||[""];return e.jsxs("div",{className:"border-b pb-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("label",{className:"text-xs font-medium text-gray-700",children:[a,":"]}),e.jsxs("button",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs flex items-center hover:bg-blue-200 transition-colors",onClick:()=>Ge(s,a),children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"AI Writing"]})]}),e.jsx("div",{className:"space-y-2",children:d.map((m,c)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx("textarea",{className:"flex-1 border border-gray-300 rounded p-2 text-xs resize-y",rows:2,placeholder:"Enter text...",value:m,onChange:j=>_e(s,a,c,j.target.value)}),e.jsx("button",{className:"ml-2 text-red-500 hover:text-red-700",onClick:()=>Re(s,a,c),title:"Remove",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},c))}),e.jsxs("button",{className:"mt-2 px-2 py-1 border border-dashed border-gray-300 rounded text-xs text-gray-600 hover:bg-gray-50 flex items-center",onClick:()=>ze(s,a),children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Text"]})]},l)}if(i.type==="number"){const d=i.options?.min||0,m=i.options?.max||100,c=(i.options?.step||10)/10,j=i.options?.precision||0,C=re(d,m,c,j),S=$e[x]||{min:d.toString(),max:m.toString(),step:c.toString()};return(!h[s]||!h[s][a])&&(k(s,a,C),Y(f=>({...f,[x]:S}))),e.jsxs("div",{className:"border-b pb-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("label",{className:"text-xs font-medium text-gray-700",children:[a,":"]}),e.jsx("div",{className:"w-4"})]}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Min"}),e.jsx("input",{type:"text",className:"w-12 h-6 border border-gray-300 rounded text-xs px-2",value:S.min,onClick:f=>{f.preventDefault(),f.stopPropagation()},onChange:f=>{f.preventDefault(),f.stopPropagation();const y=f.target.value;if(Y(w=>({...w,[x]:{...w[x],min:y}})),y===""||!isNaN(parseFloat(y))){const w=y===""?0:parseFloat(y),F=parseFloat(S.max||m.toString()),G=parseFloat(S.step||c.toString()),H=re(w,F,G,j);k(s,a,H)}}}),e.jsx("label",{className:"text-xs text-gray-600",children:"Max"}),e.jsx("input",{type:"text",className:"w-12 h-6 border border-gray-300 rounded text-xs px-2",value:S.max,onClick:f=>{f.preventDefault(),f.stopPropagation()},onChange:f=>{f.preventDefault(),f.stopPropagation();const y=f.target.value;if(Y(w=>({...w,[x]:{...w[x],max:y}})),y===""||!isNaN(parseFloat(y))){const w=parseFloat(S.min||d.toString()),F=y===""?w:parseFloat(y),G=parseFloat(S.step||c.toString()),H=re(w,F,G,j);k(s,a,H)}}}),e.jsx("label",{className:"text-xs text-gray-600",children:"Step"}),e.jsx("input",{type:"text",className:"w-12 h-6 border border-gray-300 rounded text-xs px-2",value:S.step,onClick:f=>{f.preventDefault(),f.stopPropagation()},onChange:f=>{f.preventDefault(),f.stopPropagation();const y=f.target.value;if(Y(w=>({...w,[x]:{...w[x],step:y}})),y===""||!isNaN(parseFloat(y))&&parseFloat(y)>0){const w=parseFloat(S.min||d.toString()),F=parseFloat(S.max||m.toString()),G=y===""?1:parseFloat(y),H=re(w,F,G,j);k(s,a,H)}}})]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Test values"}),e.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:(h[s]?.[a]||C).map((f,y)=>e.jsxs("div",{className:"px-2 py-0.5 bg-blue-100 text-blue-800 rounded-md flex items-center text-xs cursor-pointer hover:bg-blue-200",onClick:w=>{w.stopPropagation(),ae(s,a,f,w)},children:[e.jsx("span",{children:f}),e.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]},y))})]}),e.jsx("div",{className:"mt-1",children:e.jsx("p",{className:"text-xs text-gray-500",children:"Values are distributed evenly between Min and Max (max 10 values)"})})]},l)}else if(i.type==="combo"){const d=i.options?.values||[],m=`${s}_${a}`;return(!h[s]||!h[s][a])&&k(s,a,d.slice(0,3)),e.jsxs("div",{className:"border-b pb-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{className:"text-xs font-medium text-gray-700",children:a}),e.jsxs("div",{className:"relative dropdown-container",children:[e.jsxs("button",{className:"appearance-none border border-gray-300 rounded px-2 py-0.5 pr-6 text-xs flex items-center bg-white text-gray-700",onClick:c=>{c.preventDefault(),c.stopPropagation(),qe(s,a,c)},"data-dropdown":m,children:[e.jsx("span",{children:(h[s]?.[a]||[]).length>0?`${a}: ${(h[s]?.[a]||[]).length} selected`:`Select ${a}`}),e.jsx("div",{className:"ml-2",children:e.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]}),$[m]&&e.jsxs("div",{className:"absolute z-[9999] mt-1 w-64 bg-white border border-gray-300 rounded-md shadow-lg dropdown-menu",style:{position:"fixed",top:typeof $[m]=="object"?`${$[m].y}px`:"0px",left:typeof $[m]=="object"?`${$[m].x}px`:"0px",maxHeight:"300px",overflowY:"auto"},children:[e.jsx("div",{className:"p-2 border-b sticky top-0 bg-white",children:e.jsx("input",{type:"text",className:"w-full px-2 py-0.5 text-xs border border-gray-300 rounded",placeholder:"Search...",value:D[m]||"",onChange:c=>{c.preventDefault(),c.stopPropagation(),Ke(s,a,c.target.value)},onClick:c=>{c.preventDefault(),c.stopPropagation()},autoFocus:!0})}),e.jsxs("div",{className:"px-3 py-1.5 bg-gray-50 border-b cursor-pointer text-xs flex items-center text-gray-700 hover:bg-gray-100",onClick:c=>{c.preventDefault(),c.stopPropagation();const j=d.filter(C=>!D[m]||C.toLowerCase().includes((D[m]||"").toLowerCase()));Ye(s,a,j)},children:[e.jsx("div",{className:`w-4 h-4 mr-2 border rounded-sm flex items-center justify-center ${d.length>0&&(h[s]?.[a]||[]).length===d.length?"bg-blue-500 border-blue-500":(h[s]?.[a]||[]).length>0?"bg-blue-500 border-blue-500 opacity-50":"border-gray-300"}`,children:(h[s]?.[a]||[]).length>0&&e.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("span",{className:"font-medium",children:d.length>0&&(h[s]?.[a]||[]).length===d.length?"Deselect All":"Select All"})]}),e.jsxs("div",{className:"max-h-60 overflow-y-auto",children:[d.filter(c=>!D[m]||c.toLowerCase().includes((D[m]||"").toLowerCase())).map((c,j)=>e.jsxs("div",{className:"px-3 py-1.5 hover:bg-gray-100 cursor-pointer text-xs flex items-center text-gray-700",onClick:C=>{C.preventDefault(),C.stopPropagation(),ae(s,a,c,C)},children:[e.jsx("div",{className:`w-4 h-4 mr-2 border rounded-sm flex items-center justify-center ${(h[s]?.[a]||[]).includes(c)?"bg-blue-500 border-blue-500":"border-gray-300"}`,children:(h[s]?.[a]||[]).includes(c)&&e.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("span",{className:"whitespace-normal overflow-hidden text-ellipsis",children:c})]},j)),d.filter(c=>!D[m]||c.toLowerCase().includes((D[m]||"").toLowerCase())).length===0&&e.jsx("div",{className:"px-3 py-4 text-sm text-gray-500 text-center",children:"No matching options"})]})]})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Test values"}),e.jsxs("div",{className:"mt-1 flex flex-wrap gap-1",children:[(h[s]?.[a]||[]).map((c,j)=>e.jsxs("div",{className:"px-2 py-0.5 bg-blue-100 text-blue-800 rounded-md flex items-center text-xs",children:[e.jsx("span",{children:c}),e.jsx("svg",{className:"w-4 h-4 ml-1 cursor-pointer hover:text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:C=>{C.preventDefault(),C.stopPropagation(),ae(s,a,c,C)},children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]},j)),e.jsxs("button",{className:"px-2 py-0.5 border border-dashed border-blue-300 text-blue-600 rounded-md text-xs flex items-center hover:bg-blue-50",onClick:c=>{c.preventDefault(),c.stopPropagation();const j=`${a}${(h[s]?.[a]||[]).length+1}`;k(s,a,[...h[s]?.[a]||[],j])},children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),e.jsx("span",{children:"Add"})]})]})]})]},l)}else return(!h[s]||!h[s][a])&&k(s,a,[`${a}1`,`${a}2`,`${a}3`]),e.jsxs("div",{className:"border-b pb-3",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("label",{className:"text-xs font-medium text-gray-700",children:a})}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Test values"}),e.jsxs("div",{className:"mt-1 flex flex-wrap gap-1",children:[(h[s]?.[a]||[]).map((d,m)=>e.jsxs("div",{className:"px-2 py-0.5 bg-blue-100 text-blue-800 rounded-md flex items-center text-xs",children:[e.jsx("span",{children:d}),e.jsx("svg",{className:"w-4 h-4 ml-1 cursor-pointer hover:text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:c=>{c.preventDefault(),c.stopPropagation(),ae(s,a,d,c)},children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]},m)),e.jsxs("button",{className:"px-2 py-0.5 border border-dashed border-blue-300 text-blue-600 rounded-md text-xs flex items-center hover:bg-blue-50",onClick:d=>{d.preventDefault(),d.stopPropagation();const m=`${a}${(h[s]?.[a]||[]).length+1}`;k(s,a,[...h[s]?.[a]||[],m])},children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),e.jsx("span",{children:"Add"})]})]})]})]},l)})})]},r)}):e.jsx("div",{className:"border rounded-md mb-4 p-4 text-center text-gray-500",children:"No nodes selected. Please select a node in the workflow to configure parameters."}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx("button",{onClick:t=>se(t),className:"px-3 py-1.5 text-xs bg-gray-100 text-gray-800 rounded-md hover:bg-gray-200 transition-colors",children:"Previous"}),e.jsx("button",{onClick:t=>ke(t),className:"px-3 py-1.5 text-xs bg-pink-200 text-pink-700 rounded-md hover:bg-pink-300 transition-colors",children:"Next"})]})]})}):e.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-50 p-4",onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"mb-4 border-b pb-2 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium text-gray-800",children:"Confirm Test Configuration"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["In the selected parameter combinations, there are ",O," total runs. Each run will generate a separate image."]})]}),e.jsx("button",{className:"text-gray-400 hover:text-gray-600",onClick:B,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Q&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-600 text-xs",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx("svg",{className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("div",{className:"ml-2",children:Q})]})}),u.length>0?u.map((t,r)=>{const o=t.type||"Unknown Node",n=t.widgets||[],s=t.id;return e.jsxs("div",{className:"border rounded-md mb-4 overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-3 py-2 text-xs font-medium text-gray-700 border-b",children:[o," (ID: ",s,")"]}),e.jsx("div",{className:"p-4 space-y-3",children:n.map((i,l)=>{const a=i.name;if(!P[a])return null;const x=h[s]?.[a]||[],d=Array.isArray(x)?`[${x.join(", ")}]`:JSON.stringify(x);return e.jsxs("div",{className:l<n.length-1?"flex justify-between items-center border-b pb-2":"flex justify-between items-center",children:[e.jsx("label",{className:"font-medium text-gray-700 text-xs",children:a}),e.jsx("div",{className:"flex space-x-2 items-center",children:e.jsx("input",{type:"text",className:"w-64 h-7 border border-gray-300 rounded text-xs px-2 bg-gray-50 cursor-not-allowed text-gray-500",readOnly:!0,disabled:!0,value:d,onClick:m=>m.preventDefault()})})]},l)})})]},r)}):e.jsx("div",{className:"border rounded-md mb-4 p-4 text-center text-gray-500 text-xs",children:"No nodes selected. Please select a node in the workflow to configure parameters."}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx("button",{onClick:t=>se(t),className:"px-3 py-1.5 text-xs bg-gray-100 text-gray-800 rounded-md hover:bg-gray-200 transition-colors",children:"Previous"}),e.jsx("button",{onClick:t=>Ce(t),className:"px-3 py-1.5 text-xs bg-pink-200 text-pink-700 rounded-md hover:bg-pink-300 transition-colors",children:"Start Generation"})]})]})})};export{bt as ParameterDebugInterface};
